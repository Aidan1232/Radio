<!DOCTYPE html>
<html lang="en">
    <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Radio Player</title>
    <style>
        body {
            background-color: #222;
            color: white;
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 20px;
        }
        h1 {
            margin-bottom: 20px;
        }
        .buttons-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }
        button {
            background-color: #444;
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 14px;
            cursor: pointer;
            min-width: 150px;
            border-radius: 5px;
        }
        button:hover {
            background-color: #0077cc;
        }
        button:active {
            background-color: #005fa3;
        }
        #stop-btn {
            background-color: red;
            margin-bottom: 20px;
        }
        input[type="range"] {
            width: 300px;
        }
        .slider {
            -webkit-appearance: none;  /* Remove default styling */
            width: 300px;
            height: 8px;
            background: #444;
            border-radius: 5px;
            outline: none;
        }
        /* WebKit (Chrome, Safari) slider knob */
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: #0077cc; /* knob color */
            cursor: pointer;
            border-radius: 50%; /* round knob */
            border: 2px solid #fff;
            margin-top: -6px; /* align knob center with track */
        }
        /* Firefox slider knob */
        .slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: #0077cc; /* knob color */
            cursor: pointer;
            border-radius: 50%;
            border: 2px solid #fff;
        }
    </style>
    </head>
    <body>
        <h1>Radio Player</h1>

        <br><p>Currently playing: <span id="cp">Nothing</span></p>
        <br><label for="volume">ðŸ”Š Volume</label><br />
        <input type="range" id="volume" min="0" max="100" value="80" class="slider" id="volumeSlider"/><br><br>

        <div class="buttons-container" id="stations"></div>


        <button id="stop-btn">ðŸ›‘ Stop</button><br />

        <audio id="audio-player" controls style="display:none;">
            Your browser does not support the audio element.
        </audio>

        <!-- Include hls.js from CDN -->
        <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

        <script>
        const stations = {
            "2DRYFM Tamworth": "https://23093.live.streamtheworld.com/2DRYAAC.aac",
            "2WEB Bourke": "https://ssl1.viastreaming.net:7230/stream",
            "ABC Broken Hill": "https://mediaserviceslive.akamaized.net/hls/live/2038262/localbrokenhill/index.m3u8",
            "Triple J Broken Hill": "https://mediaserviceslive.akamaized.net/hls/live/2038308/triplejnsw/index.m3u8",
            "2DayFM Sydney": "https://wz2liw.scahw.com.au/live/2day_128.stream/playlist.m3u8",
            "C91.3 FM": "https://ice9.securenetsystems.net/C913",
        };

        const stationsDiv = document.getElementById("stations");
        const audio = document.getElementById("audio-player");
        const volumeSlider = document.getElementById("volume");
        const stopBtn = document.getElementById("stop-btn");
        const cp = document.getElementById("cp");

        let hls = null;  // hls.js instance

        // Function to play a stream, handling HLS if needed
        function playStream(name,url) {
            if (hls) {
                hls.destroy();
                hls = null;
            }
            if (Hls.isSupported() && url.endsWith('.m3u8')) {
                hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(audio);
                hls.on(Hls.Events.MANIFEST_PARSED, function() {
                    audio.play();
                });
            } else if (audio.canPlayType('application/vnd.apple.mpegurl')) {
                // Safari native HLS support
                audio.src = url;
                audio.play();
            } else {
                // For regular audio streams
                audio.src = url;
                audio.play().catch(e => {
                    return;
                });
            }
            cp.textContent = name;
        }

        // Create buttons dynamically
        for (const [name, url] of Object.entries(stations)) {
            const btn = document.createElement("button");
            btn.textContent = name;
            btn.onclick = () => playStream(name,url);
            stationsDiv.appendChild(btn);
        };

        stopBtn.onclick = () => {
            if (hls) {
                hls.destroy();
                hls = null;
            }
            audio.pause();
            audio.currentTime = 0;
            cp.textContent = "Nothing";
        };

        volumeSlider.oninput = () => {
            audio.volume = volumeSlider.value / 100;
        };

        // Set initial volume
        audio.volume = volumeSlider.value / 100;
        </script>
    </body>
</html>
